jQuery.fn.extend({insertAtCaret:function(myValue){return this.each(function(i){if(document.selection){this.focus();var sel=document.selection.createRange();sel.text=myValue;this.focus()}else if(this.selectionStart||this.selectionStart=='0'){var startPos=this.selectionStart;var endPos=this.selectionEnd;var scrollTop=this.scrollTop;this.value=this.value.substring(0,startPos)+myValue+this.value.substring(endPos,this.value.length);this.focus();this.selectionStart=startPos+myValue.length;this.selectionEnd=startPos+myValue.length;this.scrollTop=scrollTop}else{this.value+=myValue;this.focus()}})}});function decodeEntities(encodedString){var textArea=document.createElement('textarea');textArea.innerHTML=encodedString;return textArea.value}function toggleLabels(index,chart){var ci=chart;var meta=ci.getDatasetMeta(index);meta.hidden=meta.hidden===null?!ci.data.datasets[index].hidden:null;ci.update()}function toggle_all_Labels(chart){var ci=chart;ci.data.datasets.forEach(function(ds){ds.hidden=!ds.hidden});ci.update()}function CKupdate(){for(instance in CKEDITOR.instances){CKEDITOR.instances[instance].updateElement()}return true}jQuery.fn.outerHTML=function(){return(this[0])?this[0].outerHTML:''};function recaptchacallback(){var public_key=$('#accept_captcha').attr("data-pub-key");grecaptcha.render('hidden_captcha',{sitekey:public_key,callback:function(response){console.log(response)}})}function getYouTubeID(input){var video_id;video_id=input.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/i);if(video_id===null){return null}else{return video_id[1]}}jQuery.fn.scrollMinimal=function(smooth){var cTop=this.offset().top;var cHeight=this.outerHeight(true);var windowTop=$(window).scrollTop();var visibleHeight=$(window).height();if(cTop<windowTop){if(smooth){$('body').animate({'scrollTop':cTop},'slow','swing')}else{$(window).scrollTop(cTop)}}else if(cTop+cHeight>windowTop+visibleHeight){if(smooth){$('body').animate({'scrollTop':cTop-visibleHeight+cHeight},'slow','swing')}else{$(window).scrollTop(cTop-visibleHeight+cHeight)}}};var getUrlParameter=function getUrlParameter(sParam){var sPageURL=decodeURIComponent(window.location.search.substring(1)),sURLVariables=sPageURL.split('&'),sParameterName,i;for(i=0;i<sURLVariables.length;i+=1){sParameterName=sURLVariables[i].split('=');if(sParameterName[0]===sParam){return sParameterName[1]===undefined?true:sParameterName[1]}}};function setCookie(cname,cvalue,exdays){var d=new Date();d.setTime(d.getTime()+(exdays*24*60*60*1000));var expires="expires="+d.toUTCString();document.cookie=cname+"="+cvalue+";"+expires+";path=/"}jQuery.fn.highlight=function(){$(this).each(function(){var el=$(this);$("<div/>").width(el.width()).height(el.height()).css({"position":"absolute","left":el.offset().left,"top":el.offset().top,"background-color":"#f4f4b7","opacity":".6","z-index":"9999999"}).appendTo('body').fadeOut(1000).queue(function(){$(this).remove()})})};function $_GET(param){var vars={};window.location.href.replace(location.hash,'').replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(m,key,value){vars[key]=value!==undefined?value:''});if(param){return vars[param]?vars[param]:null}return vars}function disableFunction(){document.getElementById("send").disabled='true'}function validateEmail(email){var charReg=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;return charReg.test(email)}function resetFormElement(e){e.wrap('<form>').closest('form').get(0).reset();e.unwrap()}function countchars(){jQuery("#count").text('Tagline Characters: '+jQuery('#tagline').val().length)}var slug_enabled=false;var current_url=$(location).attr('pathname')+$(location).attr('search');if(current_url=='/admin.php?module=add_article'){var slug_enabled=true}function slug(update){update=update||0;if(slug_enabled==true||update==1){var title=document.getElementById("title").value;$.ajax({type:'POST',url:'/includes/ajax/slug.php',datatype:'text',data:{'title':title},success:function(data){$('#slug').val(data)}})}}$(function(){$("#slug_edit").on("click",function(event){event.preventDefault();slug_enabled=false;document.getElementById("slug").removeAttribute("readonly")})});$(function(){$("#slug_update").on("click",function(event){event.preventDefault();slug(1)})});$(function(){$(document).on('click','.trash',function(){var image_id=$(this).attr('id');var type=$(this).attr("data-type");$.ajax({type:'POST',url:'/includes/ajax/delete_image.php',data:{'image_id':image_id,'type':type},success:function(data){if(data=="YES"){$("div[id='"+image_id+"']").replaceWith('<div class="col-md-12" style="background-color: #15e563; padding: 5px;">Image Deleted</div>');if($('.uploads-'+image_id).val()){$('.uploads-'+image_id).remove()}$('html, body').animate({scrollTop:$("#preview").offset().top},0)}else{alert("can't delete the row")}}})})});$(function(){$(document).on('click','.trash_tagline',function(e){e.preventDefault();var image_id=$(this).attr('id');$.ajax({type:'POST',url:'/includes/ajax/delete_tagline_image.php',data:{'image_id':image_id},success:function(data){if(data=="YES"){$("div[id='"+image_id+"']").replaceWith('<div class="col-md-12" style="background-color: #15e563; padding: 5px;">Image Deleted</div>');$("#imageform2").scrollMinimal()}else{alert("can't delete the row")}}})})});jQuery(document).ready(function(){const toggleSwitch1=document.querySelector('#theme-slider1 input[type="checkbox"]');const toggleSwitch2=document.querySelector('#theme-slider2 input[type="checkbox"]');function switchTheme(e){if(e.target.checked){localStorage.setItem('theme','dark');document.documentElement.setAttribute('data-theme','dark');toggleSwitch1.checked=true;toggleSwitch2.checked=true}else{localStorage.setItem('theme','light');document.documentElement.setAttribute('data-theme','light');toggleSwitch1.checked=false;toggleSwitch2.checked=false}}if(document.documentElement.getAttribute("data-theme")=="dark"){if(typeof toggleSwitch1!=='undefined'){toggleSwitch1.checked=true}if(typeof toggleSwitch2!=='undefined'){toggleSwitch2.checked=true}}if(typeof toggleSwitch1!=='undefined'){toggleSwitch1.addEventListener('change',switchTheme,false)}if(typeof toggleSwitch2!=='undefined'){toggleSwitch2.addEventListener('change',switchTheme,false)}$('.cocoen').cocoen();$('.octus-editor .styles').show();function urlhelper(selected){var data;if(selected!=""){entered_url=window.prompt('Enter a valid URL');if(entered_url===null||entered_url===''){return null}}else if(selected===""){entered_url=window.prompt('Enter a valid URL');if(entered_url===null||entered_url===''){return null}selected=window.prompt('URL link text');if(selected===null||selected===''){selected='link'}}data=[entered_url,selected];return data}$(document).on('click','.octus-editor .styles .bb-button',function(e){var this_textarea=$(this).closest('div.octus-editor').find('.bbcode_editor');var start=this_textarea.prop('selectionStart');var end=this_textarea.prop('selectionEnd');var selected='';if($(this).data('snippet')){this_textarea.insertAtCaret($(this).data('snippet'))}else if($(this).data('tag')){if(start!=end){selected=this_textarea.val().slice(start,end)}if($(this).data('tag')=='ul'){selected='[li]'+selected.replace(/\r\n/g,"\r\n[/li]").replace(/[\r\n]/g,'[/li]\r\n[li]')+'[/li]';selected=selected.replace(/\[li\] +/gm,'[li]')}if($(this).data('tag')=='url'){popUpData=urlhelper(selected);entered_url=popUpData[0];selected=popUpData[1];ins='['+selected+']('+entered_url+')';this_textarea.insertAtCaret(ins)}else{this_textarea.insertAtCaret('['+$(this).data('tag')+']'+selected+'[/'+$(this).data('tag')+']')}}});$(document).on('click','.highlight-element',function(e){var item=$(this).data('highlight-class');$('.'+item).highlight()});$('#crowdfunded').dataTable({"iDisplayLength":25,colReorder:true});$('#crowdfunded').on('page.dt',function(){$('html, body').animate({scrollTop:($('.crowdfunded-page-top').offset().top)},300)});var getUrlParameter=function getUrlParameter(sParam){var sPageURL=decodeURIComponent(window.location.search.substring(1)),sURLVariables=sPageURL.split('&'),sParameterName,i;for(i=0;i<sURLVariables.length;i+=1){sParameterName=sURLVariables[i].split('=');if(sParameterName[0]===sParam){return sParameterName[1]===undefined?true:sParameterName[1]}}};$(".remove_announce").on('click',function(event){event.preventDefault();var announce_id=$(this).attr("data-announce-id");var days=$(this).attr('data-days');var expiry_days=60;if(typeof days!==typeof undefined&&days!==false){expiry_days=days}setCookie("gol_announce_"+announce_id,"set",expiry_days);$(this).closest(".announce").hide()});$(document).on('click',".toggle-nav > a",function(event){event.preventDefault();event.stopPropagation();var $toggle=$(this).closest('.toggle-nav').children('.toggle-content');if($toggle.hasClass('toggle-active')){$($toggle).removeClass('toggle-active')}else{$(".toggle-content").removeClass('toggle-active');$($toggle).addClass('toggle-active')}});$(document).click(function(e){if(!$(e.target).is('#search-button-nav .toggle-content .search-field')&&!$(e.target).is('#search-button-nav .toggle-content')){$(".toggle-content").removeClass('toggle-active')}});var charReg=/^\s*[a-zA-Z0-9-_]+\s*$/;$('.keyup-char').keyup(function(){$('span.error-keyup-1').hide();var inputVal=$(this).val();if(!charReg.test(inputVal)){$(this).parent().find(".register-warning").show()}else{$(this).parent().find(".register-warning").hide()}});$('.keyup-char-email').keyup(function(){$('div.error-keyup-1').hide();$('div.error-keyup-2').hide();var inputVal=$(this).val();if(!validateEmail(inputVal)){$(this).parent().find(".register-warning").show();$(this).parent().find(".all-ok").hide()}else{$(this).parent().find(".register-warning").hide();$(this).parent().find(".all-ok").show()}});if($.isFunction($.fn.select2)){$(".articleCategories").select2({selectOnClose:true,width:'100%',ajax:{url:"/includes/ajax/categories_ajax.php",dataType:'json',delay:250,data:function(params){return{q:params.term }},processResults:function(data){return{results:$.map(data,function(obj){return{id:obj.id,text:obj.text}})}},cache:true},minimumInputLength:2});$("#gpu_picker").select2({selectOnClose:true,width:'100%',ajax:{url:"/includes/ajax/gpu_ajax.php",dataType:'json',delay:250,data:function(params){return{q:params.term }},processResults:function(data){return{results:$.map(data,function(obj){return{id:obj.id,text:obj.text}})}},cache:true},minimumInputLength:2});$(".call_usernames").select2({selectOnClose:true,width:'100%',ajax:{url:"/includes/ajax/call_usernames.php",dataType:'json',delay:250,data:function(params){return{q:params.term }},processResults:function(data){return{results:$.map(data,function(obj){return{id:obj.id,text:obj.text}})}},cache:true},minimumInputLength:2});$(".call_user_groups").select2({selectOnClose:true,width:'100%',ajax:{url:"/includes/ajax/call_user_groups.php",dataType:'json',delay:250,data:function(params){return{q:params.term }},processResults:function(data){return{results:$.map(data,function(obj){return{id:obj.id,text:obj.text}})}},cache:true},minimumInputLength:2});$(".call_modules").select2({selectOnClose:true,width:'100%',ajax:{url:"/includes/ajax/call_modules.php",dataType:'json',delay:250,data:function(params){return{q:params.term }},processResults:function(data){return{results:$.map(data,function(obj){return{id:obj.id,text:obj.text}})}},cache:true},minimumInputLength:2})}var clipboard=new Clipboard('.btn');$('form').areYouSure();var input_counter=2;$("#add-poll").click(function(){$('#pquestion').prop("disabled",false);$('.poll-option').prop("disabled",false);$('#addButton').prop("disabled",false);$('#removeButton').prop("disabled",false);$("#create-poll").show()});$("#delete-poll").click(function(){$('#pquestion').prop("disabled",true);$('.poll-option').prop("disabled",true);$('#addButton').prop("disabled",true);$('#removeButton').prop("disabled",true);$("#create-poll").hide()});$("#addButton").click(function(){input_counter+=1;var newTextBoxDiv=$(document.createElement('div')).attr("id",'TextBoxDiv'+input_counter);newTextBoxDiv.after().html('<input type="text" name="poption[]" class="poll-option" id="option'+input_counter+'" value="" />');newTextBoxDiv.appendTo("#TextBoxesGroup")});$("#removeButton").click(function(){$("#TextBoxDiv"+input_counter).remove();input_counter-=1});$(document).on('click',".collapse_header",function(){$header=$(this);$content=$header.next();$content.slideToggle(500)});if($("#tagline").length>0){countchars();jQuery("#tagline").mousedown(countchars);jQuery("#tagline").keyup(countchars)}if($("#title").length>0){if(slug_enabled==true){slug();jQuery("#title").mousedown(slug);jQuery("#title").keyup(slug)}}$('#photoimg').off('click').on('change',function(){$("#imageform").ajaxForm({beforeSubmit:function(){$("#imageloadstatus").show();$("#imageloadbutton").hide()},success:function(data){$.each(data.data,function(index){$("#uploaded_media").append(data.data[index].output);$('#article_editor').append('<input class="uploads-'+data.data[index].media_id+'" type="hidden" name="uploads[]" value="'+data.data[index].media_id+'" />');$("#imageloadstatus").hide();$("#imageloadbutton").show();resetFormElement($('#photoimg'))})},error:function(data){$("#uploaded_media").append(data);$("#imageloadstatus").hide();$("#imageloadbutton").show();resetFormElement($('#photoimg'))}}).submit()});$('#itemdbuploadfield').off('click').on('change',function(){$("#itemdbmediaform").ajaxForm({beforeSubmit:function(){$("#imageloadstatus").show();$("#imageloadbutton").hide()},success:function(data){$.each(data.data,function(index){$("#uploaded_media").append(data.data[index].output);$('#itemdbform').append('<input class="uploads-'+data.data[index].media_id+'" type="hidden" name="uploads[]" value="'+data.data[index].media_id+'" />');$("#imageloadstatus").hide();$("#imageloadbutton").show();resetFormElement($('#itemdbuploadfield'))})},error:function(data){$("#uploaded_media").append(data);$("#imageloadstatus").hide();$("#imageloadbutton").show();resetFormElement($('#itemdbuploadfield'))}}).submit()});$(document).on('click','.show_all_filter_list',function(e){e.preventDefault();$(this).parent().parent('ul').children('li').removeClass('hidden');$(this).parent().hide()});$('#photoimg2').off('click').on('change',function(){$("#imageform2").ajaxForm({target:'#preview2',beforeSubmit:function(){$("#imageloadstatus2").show();$("#imageloadbutton2").hide()},success:function(){$("#imageloadstatus2").hide();$("#imageloadbutton2").show();resetFormElement($('#photoimg2'))},error:function(){$("#imageloadstatus2").hide();$("#imageloadbutton2").show();resetFormElement($('#photoimg2'))}}).submit()});$(".like-button").show();$(document).on('click','.likebutton',function(){var comment=$(this).parents('.comment')[0];var sid=$(this).attr("data-id");var author_id=$(this).attr("data-author-id");var article_id=$(this).attr("data-article-id");var topic_id=$(this).attr("data-topic-id");var type=$(this).attr("data-type");var $that=$(this);$.post('/includes/ajax/like.php',{comment_id:sid,author_id:author_id,article_id:article_id,topic_id:topic_id,type:type,sta:$that.find("span").text().toLowerCase()},function(returndata){if(returndata['result']=="liked"){var likeobj=$("#"+sid+" div.likes");var total_likes_obj=likeobj.find('.total_likes');var who_likes_obj=likeobj.find('.who-likes');if(returndata['type']=='comment'){var type_id='comment_id'}else if(returndata['type']=='forum_topic'){var type_id='topic_id'}else if(returndata['type']=='forum_reply'){var type_id='reply_id'}var wholikes=', <a class="who_likes" data-fancybox data-type="ajax" href="javascript:;" data-src="/includes/ajax/who_likes.php?'+type_id+'='+sid+'">Who?</a>';total_likes_obj.text(returndata['total']);who_likes_obj.html(wholikes);if($(likeobj).css('display')=='none'){likeobj.show()}var button=$(comment).find(".likebutton span");button.text("Unlike").removeClass("like").addClass("unlike")}else if(returndata['result']=="unliked"){var likeobj=$("#"+sid+" div.likes");var total_likes_obj=likeobj.find('.total_likes');var who_likes_obj=likeobj.find('.who-likes');var wholikes="";if(returndata['total']>0){wholikes=', <a class="who_likes" data-fancybox data-type="ajax" href="javascript:;" data-src="/includes/ajax/who_likes.php?comment_id='+sid+'">Who?</a>';total_likes_obj.text(returndata['total']);who_likes_obj.html(wholikes)}else{likeobj.hide()}var button=$(comment).find(".likebutton span");button.text("Like").removeClass("unlike").addClass("like")}else if(returndata['result']=="nope"){$that.qtip({content:{text:'You need to be <a href="/index.php?module=login">logged in</a> to like a post. Or <a href="/index.php?module=register">register</a> to become a GOL member'},position:{my:'bottom center',at:'top center'},style:{classes:'qtip-bootstrap qtip-shadow'},hide:{delay:2000},show:true})}})});$(document).on('click','.likearticle',function(){var this_link=$(this).parents('.article_likes')[0];var article_id=$(this).attr("data-id");var likeobj=$("#article-likes");var type=$(this).attr("data-type");var $that=$(this);$.post('/includes/ajax/like.php',{article_id:article_id,type:type,sta:$that.find("span").text().toLowerCase()},function(returndata){if(returndata['result']=="liked"){var numlikes=likeobj.html().replace(" Likes","");numlikes=parseInt(numlikes)+1;var wholikes="";if(numlikes>0){wholikes=', <a class="who_likes" data-fancybox data-type="ajax" href="javascript:;" data-src="/includes/ajax/who_likes.php?article_id='+article_id+'">Who?</a>'}$("#who-likes-article").html(wholikes);likeobj.html(numlikes+" Likes");var button=$(this_link).find(".likearticle span");button.text("Unlike").removeClass("like").addClass("unlike")}if(returndata['result']=="unliked"){var numlikes=likeobj.html().replace(" Likes","");numlikes=parseInt(numlikes)-1;var wholikes="";if(numlikes>0){wholikes=', <a class="who_likes" data-fancybox data-type="ajax" href="javascript:;" data-src="/includes/ajax/who_likes.php?article_id='+article_id+'">Who?</a>'}$("#who-likes-article").html(wholikes);likeobj.html(numlikes+" Likes");var button=$(this_link).find(".likearticle span");button.text("Like").removeClass("unlike").addClass("like")}else if(returndata['result']=="nope"){$that.qtip({content:{text:'You need to be <a href="/index.php?module=login">logged in</a> to like a post. Or <a href="/index.php?module=register">register</a> to become a GOL member'},position:{my:'bottom center',at:'top center'},style:{classes:'qtip-bootstrap qtip-shadow'},hide:{delay:2000},show:true})}})});$('.bookmark-content').click(function(event){event.preventDefault();var id=$(this).data('id');var type=$(this).data('type');var method=$(this).data('method');var page=$(this).data('page');var parent_id=$(this).data('parent-id');var link=$(this);$.post('/includes/ajax/bookmark-content.php',{'id':id,'type':type,'method':method,'parent_id':parent_id},function(data){if(data.result=='added'){link.data("method",'remove');link.addClass("bookmark-saved");link.attr('title','Remove Bookmark')}else if(data.result='removed'){if(page!='usercp'){link.data("method",'add');link.removeClass("bookmark-saved");link.attr('title','Bookmark')}else if(page=='usercp'){link.parent().parent().parent().fadeOut(500)}}})});var $this_link=$('.delete_notification').click(function(event){event.preventDefault();var note_id=$(this).data('note-id');$.post('/includes/ajax/delete-notification.php',{'note_id':note_id},function(data){data=JSON.parse(data);if(data.result==1){$('#note-'+note_id).find('span').remove();$('#note-'+note_id).fadeOut(500)}})});$(".poll_content").on("click",".close_poll",function(){var poll_id=$(this).data('poll-id');$.post('/includes/ajax/close_poll.php',{'poll_id':poll_id},function(data){if(data.result==1){$('.poll_content').load('/includes/ajax/poll_results.php',{'poll_id':poll_id});window.alert("Poll closed!")}else if(data.result==2){window.alert("Sorry, I am unable to do that.")}})});$(".poll_content").on("click",".open_poll",function(){var poll_id=$(this).data('poll-id');$.post('/includes/ajax/open_poll.php',{'poll_id':poll_id},function(data){if(data.result==1){$('.poll_content').load('/includes/ajax/poll_results.php',{'poll_id':poll_id});window.alert("Poll opened!")}else if(data.result==2){$('.poll_content').load('/includes/ajax/poll_options.php',{'poll_id':poll_id});window.alert("Poll opened!")}else if(data.result==3){window.alert("Sorry, I am unable to do that.")}})});$(".poll_content").on("click",".results_button",function(){var poll_id=$(this).data('poll-id');$('.poll_content').load('/includes/ajax/poll_results.php',{'poll_id':poll_id})});$(".poll_content").on("click",".poll_button_vote",function(){var button=$(this);var poll_id=$(this).data('poll-id');var option_id=$(this).data('option-id');$.post('/includes/ajax/poll_vote.php',{'poll_id':poll_id,'option_id':option_id},function(data){if(data.result==1){$('.poll_content').load('/includes/ajax/poll_results.php',{'poll_id':poll_id})}else if(data.result==2){window.alert("Sorry, but voting is closed!")}else if(data.result==3){window.alert("Sorry, but you have already voted in this poll!")}else{button.text("Try again later, something broke").attr('disabled','disabled');setTimeout(function(){button.removeAttr('disabled')},2000)}})});$(".poll_content").on("click",".back_vote_button",function(){var poll_id=$(this).data('poll-id');$('.poll_content').load('/includes/ajax/poll_options.php',{'poll_id':poll_id})});$(document).on('click','.claim_key',function(e){e.preventDefault();var link=$(this);var giveaway_id=$(this).attr('data-game-id');var key_id=null;if($(this).attr('data-key-id')){var key_id=$(this).attr('data-key-id')}$.post('/includes/ajax/claim_key.php',{'giveaway_id':giveaway_id,'key_id':key_id},function(data){if(data.result==1){$('#key-area').text("Here's your key: "+data.key)}if(data.result==2){$('#key-area').text("All keys have gone, sorry!")}if(data.result==3){$('#key-area').text("You have to login to redeem a key!")}if(data.result==4){$('#key-area').text("This giveaway is only for supporters!")}if(data.result==5){link.replaceWith("That key has already been taken by someone else, sorry!")}if(data.result==6){$('#key-area').text("You have already claimed one!")}})});$(document).on('click','#pc_info_update',function(e){e.preventDefault();$.post('/includes/ajax/pc-info-update.php',function(data){if(data.result==1){$('#pc_info_done').show();$('#pc_info_done').html("Thank you, your PC info has been updated!")}})});$('.votebutton').click(function(){var button=$(this);var category_id=$(this).data('category-id');var game_id=$(this).data('game-id');$.post('/includes/ajax/goty/goty_vote.php',{'category_id':category_id,'game_id':game_id},function(data){if(data.result==1){$(button).html('Vote Saved!');$(button).addClass("vote_done");$.fancybox.open({src:'#wrap',type:'inline'})}else if(data.result==2){document.getElementById("wrap").innerHTML="Sorry, but voting is closed!";$.fancybox.open({src:'#wrap',type:'inline'})}else if(data.result==3){document.getElementById("wrap").innerHTML="Sorry, but you have already used your votes in this category!";$.fancybox.open({src:'#wrap',type:'inline'})}else if(data.result==4){document.getElementById("wrap").innerHTML="Sorry, but you have already voted for that game in that category!";$.fancybox.open({src:'#wrap',type:'inline'})}else{button.text("Try again later, something broke").attr('disabled','disabled');setTimeout(function(){button.removeAttr('disabled')},2000)}})});$(document).on('click','.grab-yt-thumb',function(e){e.preventDefault();var item_id=$(this).data('itemid');var youtube_id=getYouTubeID($("input[name=trailer]").val());$.ajax({type:"GET",url:'/includes/youtube_image_proxy.php',dataType:"json",data:{'aid':item_id,'id':youtube_id,'type':'itemdb'},success:function(return_data){$('.youtube-thumb-url').val(return_data.file_url)}})});$('#generate_preview').click(function(){var article_id=$(this).data('article-id');$.post('/includes/ajax/generate_preview_code.php',{article_id:article_id}).done(function(result){$('#preview_code').val(result)})});$(document).on('click','#subscribe-link',function(e){e.preventDefault();var type=$(this).attr('data-sub');var article_id=$(this).attr('data-article-id');$.post('/includes/ajax/subscribe-article.php',{'type':type,'article-id':article_id},function(data){var myData=JSON.parse(data);if(myData.result=='subscribed'){$('#subscribe-link').attr('data-sub','unsubscribe');$("#subscribe-link").attr("href","/index.php?module=articles_full&amp;go=unsubscribe&amp;article_id="+article_id);$('#subscribe-link span').text('Unsubscribe from comments')}else if(myData.result=='unsubscribed'){$('#subscribe-link').attr('data-sub','subscribe');$("#subscribe-link").attr("href","/index.php?module=articles_full&amp;go=subscribe&amp;article_id="+article_id);$('#subscribe-link span').text('Subscribe to comments')}})});$(document).on('click',".show_blocked",function(e){e.preventDefault();var comment_id=$(this).attr("data-comment-id");$('.hidden_comment.r'+comment_id).show();$('.hidden_comment.r'+comment_id).highlight();$(this).addClass('hide_blocked').removeClass('show_blocked');$(this).children('span').addClass('minus').removeClass('plus')});$(document).on('click',".hide_blocked",function(e){e.preventDefault();var comment_id=$(this).attr("data-comment-id");$('.hidden_comment.r'+comment_id).fadeOut(500);$(this).addClass('show_blocked').removeClass('hide_blocked');$(this).children('span').addClass('plus').removeClass('minus')});$(document).on('click',".gallery_item",function(){var filename=$(this).data('filename');var id=$(this).data('id');if($("#draft_id").length==0){var draft_id=0}else{var draft_id=$("#draft_id").val()}$('#preview2').html('<img src="/uploads/tagline_gallery/'+filename+'" alt="image" />');$.fancybox.close();$.post('/includes/ajax/gallery_tagline_sessions.php',{'id':id,'filename':filename,'draft_id':draft_id})});$(document).on('click',"#preview_text_button",function(){var text=$('.bbcode_editor').val();$('.pm_text_preview').load('/includes/ajax/call_bbcode.php',{'text':text},function(){$('.preview_pm').show();$('.cocoen').cocoen();$('#preview').scrollMinimal();$('.preview_pm').highlight()})});$('.admin_article_comment_button').click(function(e){e.preventDefault();var url="/includes/ajax/article_comment_pagination.php";var form=$(this).closest('form');$.ajax({type:"POST",url:url,dataType:"json",data:$("#admin_comment").serialize(),success:function(data){if(data['result']=='done'){$('.comments').load('/includes/ajax/article_comment_pagination.php',{'type':'reload','article_id':data['article_id'],'page':data['page']},function(){$(form).removeClass('dirty');$('.comments #r'+data['comment_id']).scrollMinimal();$('.comments').highlight()});$('#comment').val('')}if(data['result']=='error'){alert(data['message'])}}}).done(function(){$('.admin_article_comment_button').prop('disabled',false)})});$('.send_admin_comment').click(function(e){e.preventDefault();var form=$(this).closest('form');var url="/includes/ajax/admin/admin_home_comment.php";$.ajax({type:"POST",url:url,dataType:"json",data:form.serialize(),success:function(data){if(data['result']=='done'){$(form).removeClass('dirty');$('.'+data['type']+'_text').val('');$('.'+data['type']+'_comments_list').html(data['text']);$('.'+data['type']+'_comments_div').highlight()}else{alert(data['message'])}}})});$(document).on('click',".send_editor_plan",function(e){e.preventDefault();var form=$(this).closest('form');var url="/includes/ajax/admin/editor_plans.php";$.ajax({type:"POST",url:url,dataType:"json",data:form.serialize()+'&type=add_plan',success:function(data){if(data['result']=='done'){$(form).removeClass('dirty');$('.editor_plans_box').html(data['text']);$('.editor_plans_content').highlight()}else{alert(data['message'])}}})});$(document).on('click',".delete_editor_plan",function(e){e.preventDefault();var note_id=$(this).data('note-id');var owner_id=$(this).data('owner-id');$.ajax({type:"POST",url:'/includes/ajax/admin/editor_plans.php',dataType:"json",data:{'note_id':note_id,'owner_id':owner_id,'type':'remove'},success:function(data){if(data['result']=='done'){$('#plan-'+note_id).fadeOut(500)}else{alert(data['message'])}}})});$(document).on('click',".conflict_confirmed",function(e){var form=$(this).closest('form');var url='/includes/ajax/admin/article_conflict_session.php';$.ajax({type:"POST",url:url,dataType:"json",data:form.serialize(),success:function(data){if(data['result']=='done'){$('.box.warning.message').fadeOut(500)}else{alert(data['message'])}}})});function ajax_page_comments(e,element){var url=window.location.href;var host=window.location.host;if(url.indexOf(host+'/admin.php?module=reviewqueue')!=-1||url.indexOf(host+'/admin.php?module=articles&view=Submitted')!=-1||url.indexOf(host+'/admin.php?module=articles&view=Submitted')!=-1){e.preventDefault();var page=element.attr("data-page");var article_id=getUrlParameter('aid');$('.comments').load('/includes/ajax/article_comment_pagination.php',{'type':'reload','article_id':article_id,'page':page},function(){$('.comments').scrollMinimal();$('.comments').highlight()});return true}return false}$(document).on('click',"ul.pagination li a, .head-list-position a",function(e){var $this=$(this);ajax_page_comments(e,$this)});$(document).on('change',".head-list-position select, .pagination",function(e){var $this=$(this).find(':selected');if(!ajax_page_comments(e,$this)){var url=$(this).val();if(url){window.location=url;}}});$('#preview_chart').click(function(){var myform=document.getElementById("chart_form");var fd=new FormData(myform);$.ajax({url:'/includes/ajax/preview_chart.php',data:fd,cache:false,processData:false,contentType:false,type:'POST',success:function(dataofconfirm){$('.chart_preview').html(dataofconfirm)}})});var label_inputs=$('.labels').length;var colour_inputs=$('.colours').length;var data_inputs=$('.data').length;$(document).on('click',"#add_label",function(){label_inputs+=1;colour_inputs+=1;data_inputs+=1;$('#label_container').append('<div id="label-'+label_inputs+'" class="input-field box fleft" style="width: 50%"><span class="addon">Label #'+label_inputs+':</span><input type="text" class="labels" name="labels[]" placeholder="label '+label_inputs+'" /></div><div id="colour-'+label_inputs+'" class="input-field box fleft" style="width: 50%"><span class="addon">Colour #'+label_inputs+':</span><input class="colours" type="text" name="colours[]" placeholder="#ffffff" /></div>');if($('#chart_grouped').prop('checked')==true){$('#data_container').append('<div id="data-'+data_inputs+'" class="box">Data for Label #'+data_inputs+'<textarea class="data" name="data[]" cols="100" rows="10"></textarea></div>')}else{$('#data_container').append('<div id="data-'+data_inputs+'" class="box">Data for Label #'+data_inputs+'<input class="data" type="text" name="data[]" /></div>')}});$(document).on('click',"#remove_label",function(){$("#label-"+label_inputs).remove();$("#colour-"+colour_inputs).remove();$("#data-"+data_inputs).remove();label_inputs-=1;colour_inputs-=1;data_inputs-=1});$(document).on('click',"#chart_grouped",function(){if($(this).prop('checked')==true){$('input.data').each(function(){var current_name=$(this).attr("name");var textbox=$(document.createElement('textarea')).attr("class","data").attr("name",current_name).attr("rows",10);$(this).replaceWith(textbox)})}else{$('textarea.data').each(function(){var current_name=$(this).attr("name");var textbox=$(document.createElement('input')).attr("class","data").attr("name",current_name).attr("type","text");$(this).replaceWith(textbox)})}});$('.admin_preview_article').click(function(e){e.preventDefault();CKupdate();var url="/includes/ajax/admin/preview_article.php";if($('#article_preview').css('display')=='none'){$.ajax({type:"POST",url:url,data:$("#article_editor").serialize(),success:function(data){$('#article_preview').html(data);$('#article_preview').show();$('.admin_preview_article').html('Close Preview');$('#article_preview').scrollMinimal()}})}else{$('#article_preview').hide();$('.admin_preview_article').html('Preview')}});$(document).on('click',".quote_function",function(e){e.preventDefault();var id=$(this).attr('data-id');var type=$(this).attr('data-type');var url="/includes/ajax/quote_comment.php";$.ajax({type:'POST',url:url,dataType:'json',data:{'id':id,'type':type},success:function(data){if(data['result']=='done'){content="[quote="+data['username']+"]"+decodeEntities(data['text']);content+="[/quote]";var current_text=$('#comment').val();$('#comment').val(current_text+content);$('#comment').scrollMinimal()}if(data['result']=='error'){alert(data['message'])}}})});$(document).on('click',".insert_tagline_image",function(e){e.preventDefault();var tagline_image=$('.tagline-image').attr('href');CKEDITOR.instances.ckeditor_gol.insertHtml('<p style="text-align:center"><img src="'+tagline_image+'" /></p>')});$(document).on('click',".uploads .add_button",function(e){var text=$(this).data('url');var type=$(this).data('type');if(type=='video'){CKEDITOR.instances.ckeditor_gol.insertHtml('<div class="ckeditor-html5-video" style="text-align: center;"><video controls="controls" src="'+text+'">&nbsp;</video></div>')}else if(type=='audio'){CKEDITOR.instances.ckeditor_gol.insertHtml('<div class="ckeditor-html5-audio" style="text-align: center;"><audio controls="controls" src="'+text+'">&nbsp;</audio></div>')}else{CKEDITOR.instances.ckeditor_gol.insertHtml('<p style="text-align:center"><a href="'+text+'" data-fancybox="images"><img src="'+text+'" /></a></p>')}});$(document).on('click',".uploads .add_thumbnail_button",function(e){var thumbnail=$(this).data('url');var big_image=$(this).data('main-url');CKEDITOR.instances.ckeditor_gol.insertHtml('<p style="text-align:center"><a href="'+big_image+'" data-fancybox="images"><img src="'+thumbnail+'" /></a></p>')});$(document).on('click',".uploads .add_static_button",function(e){var actual_gif=$(this).data('url-gif');var static_image=$(this).data('url-static');CKEDITOR.instances.ckeditor_gol.insertHtml('<p style="text-align:center"><a href="'+actual_gif+'" class="img_anim" target="_blank"><img src="'+static_image+'" /></a></p>')});$(document).on('click',"#self-submit",function(e){var username=$("#submitter-username").text();var targetEditor=CKEDITOR.instances.ckeditor_gol;var range=targetEditor.createRange();range.moveToElementEditEnd(range.root);targetEditor.insertHtml('<p>&nbsp;</p><p style="text-align:right"><em>With thanks to the original submission from '+username+'!</em></p>','html',range)});$(document).on('click',".logout_link",function(e){e.preventDefault();if(confirm('Are you sure you want to logout?')){window.location='/index.php?Logout'}});$('#comment_form').on('keydown',function(e){if(e.ctrlKey&&e.keyCode===13){$('#comment_form').trigger('submit')}});var showChar=600;var moretext="<em>Click to view long quote </em>";var lesstext="<em>Click to hide long quote </em>";var quote_count=$(".comment_quote").length;$('.comment_quote').each(function(i){var actual_text=$(this).text();var content=$(this).outerHTML();if(actual_text.length>showChar){var cite=$(this).find('cite').first().text();var cite_link='';if(cite!='Quote'){cite_link='from '+cite}var html='<span class="morecontent">'+content+'</span><a href="" class="morelink">'+moretext+cite_link+'</a><br />';$(this).replaceWith(html)}if(i+1===quote_count){if(window.location.hash){var hash=window.location.hash.substring(1);if(hash.indexOf("r")>=0){$('#'+hash)[0].scrollIntoView()}}}});$(".morelink").click(function(){var cite=$(this).prev().find('cite').first().text();var cite_link='';if(cite!='Quote'){cite_link='from '+cite}if($(this).hasClass("less")){$(this).removeClass("less");$(this).html(moretext+cite_link)}else{$(this).addClass("less");$(this).html(lesstext+cite_link)}$(this).prev().toggle();return false});var $gamesMulti=$("#articleGames").select2({selectOnClose:true,width:'100%',ajax:{url:"/includes/ajax/gamesdb/search_games.php?return_type=option&type=all",dataType:'json',delay:250,data:function(params){return{q:params.term }},processResults:function(data){return{results:$.map(data,function(obj){return{id:obj.id,text:obj.text}})}},cache:true},minimumInputLength:2});$(".clear-games").on("click",function(e){e.preventDefault();var to_clear=$(this).data('field-id');$("#"+to_clear).val(null).trigger("change")});$(".clear-username").on("click",function(e){e.preventDefault();$('.main_user_search_forum').val(null).trigger("change")});$(".genres_picker").select2({selectOnClose:true,width:'100%',ajax:{url:"/includes/ajax/gamesdb/game_genres_ajax.php",dataType:'json',delay:250,data:function(params){return{q:params.term }},processResults:function(data){return{results:$.map(data,function(obj){return{id:obj.id,text:obj.text}})}},cache:true},minimumInputLength:2});$("#game-wishlist-select").select2({selectOnClose:true,width:'100%',ajax:{url:"/includes/ajax/games_ajax.php?return_type=option&type=games_only",dataType:'json',delay:250,data:function(params){return{q:params.term }},processResults:function(data){return{results:$.map(data,function(obj){return{id:obj.id,text:obj.text}})}},cache:true},minimumInputLength:2});$("#bar-tag-select").select2({selectOnClose:true,width:'100%',ajax:{url:"/includes/ajax/categories_ajax.php",dataType:'json',delay:250,data:function(params){return{q:params.term }},processResults:function(data){return{results:$.map(data,function(obj){return{id:obj.id,text:obj.text}})}},cache:true},minimumInputLength:2});$(document).on('click',".sales-pagination li a",function(e){e.preventDefault();var form=$("#game_filters");var url="/includes/ajax/sales/display_normal.php";var page=$(this).attr("data-page");$.ajax({type:"GET",url:url,data:{'filters':form.serialize(),'page':page},success:function(data){$(form).removeClass('dirty');$('div.normal-sales').html(data);$('div.normal-sales').highlight();$('div.normal-sales').scrollMinimal();$('#sale-search').easyAutocomplete(sale_search_options);}})});$(document).on('click',".change_wishlist",function(e){e.preventDefault();var $this=$(this);var url="/includes/ajax/sales/wishlist.php";var wish_type=$(this).attr("data-type");var game_id=$(this).attr("data-game-id");$.ajax({type:"GET",url:url,data:{'type':wish_type,'game_id':game_id},success:function(data){if(data.message=='Added'){$this.html('&#9733;');$this.attr('data-type','remove');$this.highlight()}else if(data.message=='Removed'){$this.html('&#9734;');$this.attr('data-type','add');$this.highlight()}}})});$(document).on('change',"#game_filters",function(e){var form=$("#game_filters");var game_id;var search;var formName=form.attr('name');if(formName=='free'){var url="/includes/ajax/gamesdb/display_free.php";var list_update='free-list'}else if(formName=='all'){var url="/includes/ajax/gamesdb/display_all_games.php";var list_update='all-list'}else if(formName=='sales'){var url="/includes/ajax/sales/display_normal.php";var list_update='normal-sales';if(typeof $_GET('game_id')!=='undefined'){game_id=$_GET('game_id')}if($('#sale-search').val().length>0){search=$('#sale-search').val()}}else if(formName=='hidden_steam'){var url="/includes/ajax/gamesdb/display_hidden_steam.php";var list_update='free-list'}$.ajax({type:"GET",url:url,data:{'filters':form.serialize(),'game_id':game_id,'q':search},success:function(data){$(form).removeClass('dirty');$('div.'+list_update).html(data);$('div.'+list_update).highlight();$('#sale-search').easyAutocomplete(sale_search_options);}})});$(document).on('click',"#sale-search-form div.eac-item",function(e){e.preventDefault();var form=$("#game_filters");var text=$(this).text();var url="/includes/ajax/sales/display_normal.php";$.ajax({type:"GET",url:url,data:{'q':text,'filters':form.serialize()},success:function(data){$('div.normal-sales').html(data);$('div.normal-sales').highlight();$('#sale-search').easyAutocomplete(sale_search_options);}})});$(document).on('click',".filter-title .filter-link",function(){$header=$(this);$content=$header.closest('.filter-box').find('.filter-content');$content.slideToggle(500);$header.first().find('span').toggleClass("caret-down caret-right")});$('#small_pic').off('click').on('change',function(){$("#small_pic").ajaxForm({target:'#preview2',beforeSubmit:function(){$("#imageloadstatus2").show();$("#imageloadbutton2").hide()},success:function(){$("#imageloadstatus2").hide();$("#imageloadbutton2").show();resetFormElement($('#photoimg2'))},error:function(){$("#imageloadstatus2").hide();$("#imageloadbutton2").show();resetFormElement($('#photoimg2'))}}).submit()});$('#featured_pic').off('click').on('change',function(e){$("#featured-load-status").show();$("#featured-load-button").hide();e.preventDefault();var form=$(this)[0];var url=$(this).attr('action');$.ajax({type:"POST",url:url,processData:false,contentType:false,dataType:'json',data:new FormData(form),success:function(data){$("#featured-load-status").hide();$("#featured-load-button").show();$('#featured-preview').html(data.data[0].output);$('#itemdbform').append('<input class="uploads-'+data.data[0].media_id+'" type="hidden" name="uploads[]" value="'+data.data[0].media_id+'" />')}})});$(document).on('click',".games-pagination li a",function(e){e.preventDefault();var form=$("#game_filters");var formName=form.attr('name');if(formName=='free'){var url="/includes/ajax/gamesdb/display_free.php";var list_update='free-list'}else if(formName=='all'){var url="/includes/ajax/gamesdb/display_all_games.php";var list_update='all-list';console.log('hit')}var page=$(this).attr("data-page");$.ajax({type:"GET",url:url,data:{'page':page,'filters':form.serialize()},success:function(data){$('div.'+list_update).html(data);$('div.'+list_update).highlight();$('div.'+list_update).scrollMinimal();$('#free-search').easyAutocomplete(free_search_options);}})});$(document).on('click',"#free-search-form div.eac-item",function(e){e.preventDefault();var text=$(this).text();var url="/includes/ajax/gamesdb/display_free.php";$.ajax({type:"GET",url:url,data:{'q':text},success:function(data){$('div.free-list').html(data);$('div.free-list').highlight();$('#free-search').easyAutocomplete(free_search_options);}})});var picker_url='games';$(".game_picker").select2({selectOnClose:true,width:'100%',ajax:{url:function(){if($(this).data('picker')=='games'){var search_type=null;if(typeof $(this).data('type')!=='undefined'){search_type='&type='+$(this).data('type')}return "/includes/ajax/gamesdb/search_games.php?return_type=option"+search_type}else if($(this).data('picker')=='devs'){return '/includes/ajax/gamesdb/search_devs.php'}},dataType:'json',delay:250,data:function(params){return{q:params.term }},processResults:function(data){return{results:$.map(data,function(obj){return{id:obj.id,text:obj.text}})}},cache:true},minimumInputLength:2});var static_suffix="_static.jpg";var gif_suffix=".gif";$(document).on('click',".img_anim",function(e){e.preventDefault();var actual_gif=$(this).attr("href");var image=$(this).find('img:first-child');var image_src=$(this).find('img:first-child').attr("src");if(image_src.indexOf('jpg')!==-1){image.css({opacity:0.3});var $overlay=$('<div class="gif-loader"></div>');$overlay.css({position:"relative",display:"inline-block",width:image.width(),height:image.height(),backgroundPosition:"center center",backgroundImage:"url(/templates/default/images/bigloader.gif)",backgroundRepeat:"no-repeat"});image.wrap($overlay);$('<img src="'+actual_gif+'">').on('load',function(){image.closest(".gif-loader").replaceWith('<img src="'+actual_gif+'" />')})}else{image.attr("src",image_src.replace(gif_suffix,static_suffix))}});$(document).on('click','.delete_comment',function(e){e.preventDefault();var comment_id=$(this).attr('data-comment-id');if(confirm('Are you sure you wish to delete that comment?')){$.post('/includes/ajax/delete_comment.php',{'comment_id':comment_id},function(data){if(data.result=="removed"){$('.r'+comment_id).fadeOut(500)}})}else{}});$(document).on('click','.delete_forum_post',function(e){e.preventDefault();var post_id=$(this).attr('data-post-id');var type=$(this).attr('data-type');if(confirm('Are you sure you wish to delete that forum post?')){$.post('/includes/ajax/delete_forum_post.php',{'post_id':post_id,'type':type},function(data){if(data.result=="removed"){if(type=='reply'){$('.r'+post_id).fadeOut(500)}else if(type=='topic'){window.location.href="/forum/"+data.forum_id}}})}else{}});$(document).on('click','.accept_video',function(e){e.preventDefault();var video_id=$(this).attr("data-video-id");$(this).closest('.hidden_video').replaceWith('<div class="youtube-embed-wrapper" style="position:relative;padding-bottom:56.25%;padding-top:30px;height:0;overflow:hidden"><iframe allowfullscreen="" frameborder="0" height="360" src="https://www.youtube-nocookie.com/embed/'+video_id+'?rel=0" style="position:absolute;top:0;left:0;width:100%;height:100%" width="640"></iframe></div>');Cookies.set('gol_youtube_consent','yup',{expires:60})});$(document).on('click','#youtube-cookie-slider',function(e){if(this.checked){Cookies.set('gol_youtube_consent','yup',{expires:60});$(".youtube_status_text").text('On')}else{$("#youtube-cookie-slider").prop('checked',false);$(".youtube_status_text").text('Off');Cookies.set('gol_youtube_consent','nope',{expires:60})}});$('.reg-button').attr('disabled',true);$(document).on('change','#policy_agree, #spam_list',function(e){if($("#policy_agree").is(':checked')&&$("#spam_list").is(':checked')){$('.reg-button').attr('disabled',false)}else{$('.reg-button').attr('disabled',true)}});$(document).on('click','#accept_captcha',function(e){$.getScript('https://www.google.com/recaptcha/api.js?onload=recaptchacallback&render=explicit')});$(document).on('click',".load_admin_notifications",function(e){e.preventDefault();var load_link=$(this);var last_id=$(this).attr("data-last-id");var url="/includes/ajax/admin/load_notifications.php";$.ajax({type:"GET",url:url,data:{'last_id':last_id},success:function(data){if(data.result=='done'){$('.notifications-list').append(data.text);load_link.attr('data-last-id',data.last_id);if(data.total_left==0){load_link.replaceWith('None left!')}}}})})});